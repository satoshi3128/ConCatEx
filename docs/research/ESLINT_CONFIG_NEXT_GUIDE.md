# eslint-config-next ガイドライン：Next.jsプロジェクトの品質を守るためのルール解説

## 1. はじめに

### 1.1. `eslint-config-next` とは？

`eslint-config-next` は、Next.jsの公式チームが提供するESLintの推奨ルールセットです。これは単なる構文チェッカーではなく、Next.jsアプリケーションの**パフォーマンス、アクセシビリティ、セキュリティ、そしてベストプラクティス**を維持するための「ガイド」の役割を果たします。

このプロジェクトでは、Next.jsチームの知見が凝縮されたこのルールセットを導入することで、高品質でメンテナンス性の高いコードベースを維持することを目的としています。

### 1.2. なぜこのガイドが必要か？

ESLintのエラーや警告が表示されたとき、ただ修正するだけでなく「**なぜこのルールが重要なのか**」を理解することが、開発者としての成長と、より良いプロダクト開発につながります。このガイドは、`eslint-config-next`がチェックしている主要なルールの背景と目的を解説します。

---

## 2. 主要なルールカテゴリと目的

`eslint-config-next`が提供するルールは、大きく分けて以下の4つのカテゴリに分類できます。

| カテゴリ                      | 目的                                                                      | 主なプラグイン                                     |
| :---------------------------- | :------------------------------------------------------------------------ | :------------------------------------------------- |
| **Next.js特有のルール**       | パフォーマンス最適化、SEO向上、フレームワークの正しい利用を促進する       | `eslint-plugin-next`                               |
| **Reactのベストプラクティス** | バグの少ない、効率的なReactコンポーネントの実装を支援する                 | `eslint-plugin-react`, `eslint-plugin-react-hooks` |
| **アクセシビリティ (a11y)**   | すべてのユーザーがアプリケーションを利用できるよう、Web標準への準拠を促す | `eslint-plugin-jsx-a11y`                           |
| **一般的なコード品質**        | 可読性が高く、一貫性のあるJavaScript/TypeScriptのコードを維持する         | ESLint Core Rules                                  |

---

## 3. 具体的なルール例と実践

日常の開発で遭遇しやすい、特に重要なルールをいくつか紹介します。

### 3.1. Next.js特有のルール

#### ① `<img>` タグの代わりに `<Image>` コンポーネントを使用する (`@next/next/no-img-element`)

- **悪い例**: `<img src="/my-image.png" alt="説明">`
- **良い例**: `import Image from 'next/image'; <Image src="/my-image.png" alt="説明" width={500} height={300} />`
- **なぜ重要か？**: `next/image`は、画像をWebPなどのモダンな形式に自動で変換し、遅延読み込み（Lazy Loading）や、CLS（Cumulative Layout Shift）を防ぐためのサイズ指定を必須にすることで、サイトの表示速度とパフォーマンスを劇的に向上させます。

#### ② `<a>` タグの代わりに `<Link>` コンポーネントを使用する (`@next/next/no-html-link-for-pages`)

- **悪い例**: `<a href="/about">About</a>`
- **良い例**: `import Link from 'next/link'; <Link href="/about">About</Link>`
- **なぜ重要か？**: `<Link>`コンポーネントは、ページ遷移時にページ全体をリロードするのではなく、必要な部分だけをクライアントサイドで高速に遷移させます（Client-Side Navigation）。これにより、アプリケーションのような滑らかなユーザー体験が実現されます。

### 3.2. Reactのベストプラクティス

#### ① Hooksのルールを遵守する (`react-hooks/rules-of-hooks`)

- **悪い例**: `if (condition) { const [state, setState] = useState(0); }`
- **良い例**: `const [state, setState] = useState(0); if (condition) { /* stateを使った処理 */ }`
- **なぜ重要か？**: ReactのHooksは、常にコンポーネントのトップレベルで、同じ順序で呼び出される必要があります。このルールを破ると、Reactが状態を正しく管理できなくなり、予測不能なバグの原因となります。

#### ② `useEffect` の依存配列を正しく設定する (`react-hooks/exhaustive-deps`)

- **悪い例**: `useEffect(() => { console.log(userId); }, []); // userIdが外部から渡されているのに、依存配列が空`
- **良い例**: `useEffect(() => { console.log(userId); }, [userId]);`
- **なぜ重要か？**: `useEffect`内で使用するコンポーネント外の変数（propsやstate）は、依存配列に含める必要があります。これを怠ると、変数が更新されてもエフェクトが再実行されず、古い値を参照し続ける「stale closure」というバグを引き起こします。

### 3.3. アクセシビリティ (a11y)

#### ① 画像には必ず`alt`属性を設定する (`jsx-a11y/alt-text`)

- **悪い例**: `<Image src="..." width={100} height={100} />`
- **良い例**: `<Image src="..." alt="ユーザーのプロフィール画像" width={100} height={100} />`
- **なぜ重要か？**: `alt`テキストは、画像が表示されない場合や、スクリーンリーダーを利用する視覚障がいのあるユーザーに対して、画像の内容を伝えるための唯一の情報です。SEOの観点からも重要です。

#### ② クリック可能な要素には適切な役割を与える (`jsx-a11y/click-events-have-key-events`)

- **悪い例**: `<div onClick={handleClick}>クリックしてね</div>`
- **良い例**: `<button onClick={handleClick}>クリックしてね</button>`
- **なぜ重要か？**: `<div>`などの意味を持たない要素にクリックイベントを設定すると、キーボード（TabキーやEnterキー）で操作することができません。`button`要素を使えば、自動的にキーボード操作やスクリーンリーダーに対応でき、すべてのユーザーが操作可能になります。

---

## 4. 運用方法

1.  **エディタと連携する**: VS CodeにESLint拡張機能を導入し、コード記述中にリアルタイムでフィードバックを受け取れるようにします。
2.  **コマンドで確認する**: `npm run lint` を実行することで、プロジェクト全体のコード品質をいつでも確認できます。
3.  **エラーを理解する**: エラーメッセージが表示されたら、このガイドを参照し、そのルールがなぜ重要なのかを理解した上で修正に取り組みましょう。安易にルールを無効化（`// eslint-disable-next-line`）することは、品質を損なう可能性があるため、慎重に判断してください。

## 5. まとめ

`eslint-config-next`は、単なるルール集ではなく、Next.jsアプリケーション開発における「ベストプラクティスの集合体」です。これらのルールに従うことは、バグを未然に防ぎ、パフォーマンスを向上させ、そして何よりも、長期的にメンテナンスしやすい高品質なコード資産を築くための、最も確実な方法の一つです。
